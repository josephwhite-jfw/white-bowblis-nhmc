source("C:/Repositories/white-bowblis-nhmc/regressions/did_twfe.R", echo = TRUE)
gc()
gc()
library(dplyr)
library(fixest)
library(readr)
panel_fp <- "C:/Repositories/white-bowblis-nhmc/data/clean/panel.csv"
keep_cols <- c(
"cms_certification_number","year_month","quarter",
"event_time","treatment","post", "anticipation",
"government","non_profit", "chain", "beds",
"occupancy_rate", "pct_medicare","pct_medicaid",
"cm_q_state_2", "cm_q_state_3", "cm_q_state_4",
"rn_hppd","lpn_hppd","cna_hppd","total_hppd"
)
df <- read_csv(panel_fp, show_col_types = FALSE, col_select = all_of(keep_cols)) %>%
mutate(
year_month = as.character(year_month),
cms_certification_number = as.factor(cms_certification_number)
)
library(dplyr)
library(fixest)
library(readr)
panel_fp <- "C:/Repositories/white-bowblis-nhmc/data/clean/panel.csv"
keep_cols <- c(
"cms_certification_number","year_month","quarter",
"event_time","treatment","post", "anticipation",
"government","non_profit", "chain", "beds",
"occupancy_rate", "pct_medicare","pct_medicaid",
"cm_q_state_2", "cm_q_state_3", "cm_q_state_4",
"rn_hppd","lpn_hppd","cna_hppd","total_hppd"
)
df <- read_csv(panel_fp, show_col_types = FALSE, col_select = all_of(keep_cols)) %>%
mutate(
year_month = as.character(year_month),
cms_certification_number = as.factor(cms_certification_number)
)
View(df)
library(dplyr)
library(fixest)
library(readr)
panel_fp <- "C:/Repositories/white-bowblis-nhmc/data/clean/panel.csv"
keep_cols <- c(
"cms_certification_number","year_month","quarter",
"event_time","treatment","post", "anticipation",
"time", "time_treated",
"government","non_profit", "chain", "beds",
"occupancy_rate", "pct_medicare","pct_medicaid",
"cm_q_state_2", "cm_q_state_3", "cm_q_state_4",
"rn_hppd","lpn_hppd","cna_hppd","total_hppd"
)
df <- read_csv(panel_fp, show_col_types = FALSE, col_select = all_of(keep_cols)) %>%
mutate(
year_month = as.character(year_month),
cms_certification_number = as.factor(cms_certification_number)
)
View(df)
source("C:/Repositories/white-bowblis-nhmc/regressions/did_event_study.R", echo = TRUE)
View(df)
# set never-treated cohorts to Inf
df$time_treated[is.na(df$time_treated)] <- Inf
View(df)
# example feols call
sun_ab_did = feols(total_hppd ~ controls + sunab(time_treated, time) | cms_certification_number + time, df)
controls <- paste(
"government + non_profit + chain + beds +",
"occupancy_rate + pct_medicare + pct_medicaid +",
"cm_q_state_2 + cm_q_state_3 + cm_q_state_4"
)
sun_ab_did = feols(total_hppd ~ controls + sunab(time_treated, time) | cms_certification_number + time, df)
sun_ab_did = feols(total_hppd ~ government + non_profit + sunab(time_treated, time) | cms_certification_number + time, df)
gc()
source("C:/Repositories/white-bowblis-nhmc/regressions/did_event_study.R", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/did_event_study.R", echo = TRUE)
source("C:/Repositories/white-bowblis-nhmc/regressions/did_event_study.R", echo = TRUE)
